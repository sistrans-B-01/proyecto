SELECT 'HABITACION' AS ALOJAMIENTO, MAX(SUMAS) AS MAXIMO, MEJORPAGADA, MAX(OCU) AS MAXOCU, MEJOROCUPA
FROM( SELECT SUM(RESERVA.COSTOPAGADO) AS SUMAS, RESERVA.FECHADEPAGO AS MEJORPAGADA, COUNT(disponible) AS OCU, reserva.fechallegada AS MEJOROCUPA
      FROM OFERTAHABITACION, OFERTA, RESERVA
      WHERE( OFERTAHABITACION.IDOFERTA= OFERTA.ID AND RESERVA.IDOFERTA= OFERTA.ID AND oferta.disponible='N')
      GROUP BY RESERVA.FECHADEPAGO, reserva.fechallegada
      HAVING(RESERVA.FECHADEPAGO <= '10-ENE-2020' AND RESERVA.FECHADEPAGO>= '28-DIC-2019')
     )
WHERE ROWNUM <=5    
GROUP BY MEJORPAGADA, MEJOROCUPA     

UNION

SELECT 'VIVIENDA' AS ALOJAMIENTO, MAX(SUMAS) AS MAXIMO, MEJORPAGADA, MAX(OCU) AS MAXOCU, MEJOROCUPA
FROM( SELECT SUM(RESERVA.COSTOPAGADO) AS SUMAS, RESERVA.FECHADEPAGO AS MEJORPAGADA, COUNT(disponible) AS OCU, reserva.fechallegada AS MEJOROCUPA
      FROM OFERTAVIVIENDA, OFERTA, RESERVA
      WHERE (OFERTAVIVIENDA.IDOFERTA= OFERTA.ID AND RESERVA.IDOFERTA= OFERTA.ID AND oferta.disponible='N')
      GROUP BY RESERVA.FECHADEPAGO, reserva.fechallegada
      HAVING(RESERVA.FECHADEPAGO <= '10-ENE-2020' AND RESERVA.FECHADEPAGO>= '28-DIC-2019')
    )
WHERE ROWNUM<= 5
GROUP BY MEJORPAGADA, MEJOROCUPA

UNION
SELECT 'APARTAMENTO' AS ALOJAMIENTO, MAX(SUMAS) AS MAXIMO, MEJORPAGADA, MAX(OCU) AS MAXOCU, MEJOROCUPA
FROM( SELECT SUM(RESERVA.COSTOPAGADO) AS SUMAS, RESERVA.FECHADEPAGO AS MEJORPAGADA, COUNT(disponible) AS OCU, reserva.fechallegada AS MEJOROCUPA
      FROM OFERTAAPARTAMENTO, OFERTA, RESERVA
      WHERE (OFERTAAPARTAMENTO.IDOFERTA= OFERTA.ID AND RESERVA.IDOFERTA= OFERTA.ID AND oferta.disponible='N')
      GROUP BY RESERVA.FECHADEPAGO, reserva.fechallegada
      HAVING(RESERVA.FECHADEPAGO <= '10-ENE-2020' AND RESERVA.FECHADEPAGO>= '28-DIC-2019')
    )
WHERE ROWNUM<= 5
GROUP BY MEJORPAGADA, MEJOROCUPA
ORDER BY MAXIMO DESC;